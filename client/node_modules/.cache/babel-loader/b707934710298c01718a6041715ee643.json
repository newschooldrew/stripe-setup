{"ast":null,"code":"var _jsxFileName = \"/Users/andrewperez/Documents/projects/stripe/stripe-setup/client/src/components/CheckoutForm.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport api from \"./api\";\nexport default function CheckoutForm() {\n  const [amount, setAmount] = useState(0);\n  const [currency, setCurrency] = useState(\"\");\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const stripe = useStripe();\n  const elements = useElements();\n  useEffect(() => {\n    // Step 1: Fetch product details such as amount and currency from\n    // API to make sure it can't be tampered with in the client.\n    api.getProductDetails().then(productDetails => {\n      setAmount(productDetails.amount / 100);\n      setCurrency(productDetails.currency);\n    }); // Step 2: Create PaymentIntent over Stripe API\n\n    api.createPaymentIntent().then(clientSecret => {\n      setClientSecret(clientSecret);\n    }).catch(err => {\n      setError(err.message);\n    });\n  }, []);\n\n  const handleSubmit = async ev => {\n    ev.preventDefault();\n    setProcessing(true); // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value\n        }\n      }\n    });\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setSucceeded(true);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent);\n    }\n  };\n\n  const renderSuccess = () => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-field-success message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }\n    }, \"Your test payment succeeded\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }\n    }, \"View PaymentIntent response:\"), /*#__PURE__*/React.createElement(\"pre\", {\n      className: \"sr-callout\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"code\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }\n    }, JSON.stringify(metadata, null, 2))));\n  };\n\n  const renderForm = () => {\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\"\n          }\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\"\n        }\n      }\n    };\n    return /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, currency.toLocaleUpperCase(), \" \", amount.toLocaleString(navigator.language, {\n      minimumFractionDigits: 2\n    }), \" \"), /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }\n    }, \"Pre-order the Pasha package\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"name\",\n      name: \"name\",\n      placeholder: \"Name\",\n      autoComplete: \"cardholder\",\n      className: \"sr-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sr-combo-inputs-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CardElement, {\n      className: \"sr-input sr-card-element\",\n      options: options,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    }))), error && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message sr-field-error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 19\n      }\n    }, error), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      disabled: processing || !clientSecret || !stripe,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }\n    }, processing ? \"Processing…\" : \"Pay\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"checkout-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-payment-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sr-form-row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }), succeeded ? renderSuccess() : renderForm()));\n}","map":{"version":3,"sources":["/Users/andrewperez/Documents/projects/stripe/stripe-setup/client/src/components/CheckoutForm.js"],"names":["React","useEffect","useState","CardElement","useStripe","useElements","api","CheckoutForm","amount","setAmount","currency","setCurrency","clientSecret","setClientSecret","error","setError","metadata","setMetadata","succeeded","setSucceeded","processing","setProcessing","stripe","elements","getProductDetails","then","productDetails","createPaymentIntent","catch","err","message","handleSubmit","ev","preventDefault","payload","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","console","log","paymentIntent","renderSuccess","JSON","stringify","renderForm","options","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","toLocaleUpperCase","toLocaleString","navigator","language","minimumFractionDigits"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport api from \"./api\";\n\nexport default function CheckoutForm() {\n  const [amount, setAmount] = useState(0);\n  const [currency, setCurrency] = useState(\"\");\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const stripe = useStripe();\n  const elements = useElements();\n\n  useEffect(() => {\n    // Step 1: Fetch product details such as amount and currency from\n    // API to make sure it can't be tampered with in the client.\n    api.getProductDetails().then((productDetails) => {\n      setAmount(productDetails.amount / 100);\n      setCurrency(productDetails.currency);\n    });\n\n    // Step 2: Create PaymentIntent over Stripe API\n    api\n      .createPaymentIntent()\n      .then((clientSecret) => {\n        setClientSecret(clientSecret);\n      })\n      .catch((err) => {\n        setError(err.message);\n      });\n  }, []);\n\n  const handleSubmit = async (ev) => {\n    ev.preventDefault();\n    setProcessing(true);\n\n    // Step 3: Use clientSecret from PaymentIntent and the CardElement\n    // to confirm payment with stripe.confirmCardPayment()\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value,\n        },\n      },\n    });\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setSucceeded(true);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent);\n    }\n  };\n\n  const renderSuccess = () => {\n    return (\n      <div className=\"sr-field-success message\">\n        <h1>Your test payment succeeded</h1>\n        <p>View PaymentIntent response:</p>\n        <pre className=\"sr-callout\">\n          <code>{JSON.stringify(metadata, null, 2)}</code>\n        </pre>\n      </div>\n    );\n  };\n\n  const renderForm = () => {\n    const options = {\n      style: {\n        base: {\n          color: \"#32325d\",\n          fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n          fontSmoothing: \"antialiased\",\n          fontSize: \"16px\",\n          \"::placeholder\": {\n            color: \"#aab7c4\",\n          },\n        },\n        invalid: {\n          color: \"#fa755a\",\n          iconColor: \"#fa755a\",\n        },\n      },\n    };\n\n    return (\n      <form onSubmit={handleSubmit}>\n        <h1>\n          {currency.toLocaleUpperCase()}{\" \"}\n          {amount.toLocaleString(navigator.language, {\n            minimumFractionDigits: 2,\n          })}{\" \"}\n        </h1>\n        <h4>Pre-order the Pasha package</h4>\n\n        <div className=\"sr-combo-inputs\">\n          <div className=\"sr-combo-inputs-row\">\n            <input\n              type=\"text\"\n              id=\"name\"\n              name=\"name\"\n              placeholder=\"Name\"\n              autoComplete=\"cardholder\"\n              className=\"sr-input\"\n            />\n          </div>\n\n          <div className=\"sr-combo-inputs-row\">\n            <CardElement\n              className=\"sr-input sr-card-element\"\n              options={options}\n            />\n          </div>\n        </div>\n\n        {error && <div className=\"message sr-field-error\">{error}</div>}\n\n        <button\n          className=\"btn\"\n          disabled={processing || !clientSecret || !stripe}\n        >\n          {processing ? \"Processing…\" : \"Pay\"}\n        </button>\n      </form>\n    );\n  };\n\n  return (\n    <div className=\"checkout-form\">\n      <div className=\"sr-payment-form\">\n        <div className=\"sr-form-row\" />\n        {succeeded ? renderSuccess() : renderForm()}\n      </div>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}